namespace sprites {
    /**
     * Sets get the sprite's tile X position. Assuming 16x16 tile
     */
    export function getTileX(sprite: Sprite) : number {
        if (!sprite) return 0;
        return sprite.x / 16;
    }

    /**
     * Sets get the sprite's tile Y position. Assuming 16x16 tile
     */
    export function getTileY(sprite: Sprite) : number {
        if (!sprite) return 0;
        return sprite.y / 16;
    }
}







controller.B.onEvent(ControllerButtonEvent.Pressed, function () {
    let speed = 50
    let hadukinImg = img`
        . . . . . . . . . . . . . . . . . .
        . . . . . . . . . . . . . . . . . .
        . . . . . . . . . . . . . . . . . .
        . . 8 8 8 8 8 8 8 8 8 8 . . . . . .
        . 8 8 9 9 9 9 9 9 9 9 8 8 . . . . .
        8 8 8 9 1 9 1 9 1 9 9 8 8 . . . . .
        8 8 8 9 9 1 1 1 1 1 9 8 8 . . . . .
        8 8 8 9 1 1 1 1 1 9 9 8 8 . . . . .
        8 8 8 9 9 1 1 1 1 1 9 8 8 . . . . .
        8 8 8 9 1 1 1 1 1 9 9 8 8 . . . . .
        8 8 8 9 9 1 9 1 9 1 9 8 8 . . . . .
        . 8 8 9 9 9 9 9 9 9 9 8 8 . . . . .
        . . 8 8 8 8 8 8 8 8 8 8 . . . . . .
        . . . . . . . . . . . . . . . . . .
        . . . . . . . . . . . . . . . . . .
        . . . . . . . . . . . . . . . . . .
    `

    let projImg = hadukinImg

    if(oldLady.image == oldLadyImgClone){
      speed = -50
  
    } else {
      speed = 50  
    }


    let projectile = sprites.createProjectileFromSprite(projImg, oldLady, speed , 0)
})






controller.A.onEvent(ControllerButtonEvent.Pressed, function () {
    let oldLadyTileX = sprites.getTileX(oldLady);
    if(oldLady.image == oldLadyImgClone){
        oldLadyTileX--
    } else {
        oldLadyTileX++
    }

    let l = tiles.getTileLocation(oldLadyTileX, sprites.getTileY(oldLady))
    tiles.setTileAt(l, myTiles.tile2)
    tiles.setWallAt(l, true)
})

controller.left.onEvent(ControllerButtonEvent.Pressed, function() {
    oldLady.setImage(oldLadyImgClone)
})

controller.right.onEvent(ControllerButtonEvent.Pressed, function() {
    oldLady.setImage(oldLadyImg)
})

let oldLadyImg = img`
    ...........................................................
    ...........................................................
    ...........................................................
    ...........................................................
    ..............................22...........................
    ......11......11.............222...........................
    .....111111111111........ee.2212...........................
    .....111f1111f111........2222212...........................
    .....111111111111........2222212...........................
    .....111111111111........2222212...........................
    .....11111ff11111........2222212...........................
    .....111111111111........ee.2212...........................
    .....11111fff1111........ee..222...........................
    .111111111111111111.....1111..22...........................
    11111111111111111111...1ffff...............................
    111111111111111111111.111111...............................
    111111111111111111111111ffff...............................
    1111111111111111111111111111...............................
    11111111111111111.1111111ee................................
    11111111111111111..11111.ee................................
    11111111111111111...111..ee................................
    1f1f1111111111111....1...ee................................
    1f1f1111111111111........ee................................
    1f1f1111111111111........ee................................
    .f1f.111111111111..........................................
    .....111111111111..........................................
    .....111111111111..........................................
    .....11111..11111..........................................
    .....11111..11111..........................................
    .....11111..11111..........................................
    .....11111..11111..........................................
    .....11111..11111..........................................
    .....11111..11111..........................................
    .....11111..11111..........................................
    .....11111..11111..........................................
    .....11111..11111..........................................
    .....11111..11111..........................................
    .....11111..11111..........................................
    .....11111..11111..........................................
    .....11111..11111..........................................
    .....11111..11111..........................................
    ...........................................................
    ...........................................................
    ...........................................................
    ...........................................................
    ...........................................................
    ...........................................................
    ...........................................................
    ...........................................................
    ...........................................................
`
let oldLadyImgClone = oldLadyImg.clone()
oldLadyImgClone.flipX()
let oldLady = sprites.create(oldLadyImg, SpriteKind.Player)
controller.moveSprite(oldLady)
scene.cameraFollowSprite(oldLady)